{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\User\\\\Desktop\\\\werk\\\\calorie-calc\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./start-page.component.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./start-page.component.scss?ngResource\";\nimport { Component } from '@angular/core';\nimport { FormBuilder, Validators } from \"@angular/forms\";\nimport { GoogleLoginProvider, SocialAuthService } from \"angularx-social-login\";\nimport { UserDataService } from \"../user-data.service\";\nimport { Router } from \"@angular/router\";\nimport { Store } from \"@ngrx/store\";\nimport { userLoginAction } from \"../store/user/user.action\";\nlet StartPageComponent = class StartPageComponent {\n  constructor(formBuilder, udService, router, store, socialAuthService) {\n    this.formBuilder = formBuilder;\n    this.udService = udService;\n    this.router = router;\n    this.store = store;\n    this.socialAuthService = socialAuthService;\n    this.title = 'calorie calendar';\n    this.loginForm = this.formBuilder.group({\n      email: ['', Validators.required],\n      password: ['', Validators.required]\n    });\n    this.isLoggedin = false;\n  }\n\n  ngOnInit() {\n    this.socialAuthService.authState.subscribe(user => {\n      this.socialUser = user;\n      this.isLoggedin = user != null;\n    });\n  }\n\n  loginWithGoogle() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const users = _this.udService.loadUsers();\n\n      try {\n        const authUser = yield _this.socialAuthService.signIn(GoogleLoginProvider.PROVIDER_ID);\n        _this.udService.userId = authUser.id;\n        console.log(_this.udService.userId);\n        const user = {\n          id: authUser.id,\n          gender: '',\n          heightCm: 0,\n          weightkg: 0,\n          minCal: 0,\n          maxCal: 0,\n          fats: 0,\n          proteins: 0,\n          carbohydrates: 0\n        };\n\n        if (!users.length) {\n          _this.udService.saveUser(user, authUser.id);\n        } else {\n          const foundUser = users.find(user => user.id === authUser.id);\n\n          _this.udService.saveUser(foundUser !== null && foundUser !== void 0 ? foundUser : user, _this.udService.userId);\n        }\n\n        _this.store.dispatch(userLoginAction({\n          id: authUser.id\n        }));\n\n        _this.router.navigate(['/profile']);\n      } catch (e) {\n        console.error(e); // Any error handling scenario\n      }\n    })();\n  }\n\n  logOut() {\n    this.udService.userId = '';\n    this.socialAuthService.signOut();\n  }\n\n};\n\nStartPageComponent.ctorParameters = () => [{\n  type: FormBuilder\n}, {\n  type: UserDataService\n}, {\n  type: Router\n}, {\n  type: Store\n}, {\n  type: SocialAuthService\n}];\n\nStartPageComponent = __decorate([Component({\n  selector: 'app-start-page',\n  template: __NG_CLI_RESOURCE__0,\n  providers: [SocialAuthService],\n  styles: [__NG_CLI_RESOURCE__1]\n})], StartPageComponent);\nexport { StartPageComponent };","map":{"version":3,"sources":["C:/Users/User/Desktop/werk/calorie-calc/src/app/start-page/start-page.component.ts"],"names":["__decorate","__NG_CLI_RESOURCE__0","__NG_CLI_RESOURCE__1","Component","FormBuilder","Validators","GoogleLoginProvider","SocialAuthService","UserDataService","Router","Store","userLoginAction","StartPageComponent","constructor","formBuilder","udService","router","store","socialAuthService","title","loginForm","group","email","required","password","isLoggedin","ngOnInit","authState","subscribe","user","socialUser","loginWithGoogle","users","loadUsers","authUser","signIn","PROVIDER_ID","userId","id","console","log","gender","heightCm","weightkg","minCal","maxCal","fats","proteins","carbohydrates","length","saveUser","foundUser","find","dispatch","navigate","e","error","logOut","signOut","ctorParameters","type","selector","template","providers","styles"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport __NG_CLI_RESOURCE__0 from \"./start-page.component.html?ngResource\";\r\nimport __NG_CLI_RESOURCE__1 from \"./start-page.component.scss?ngResource\";\r\nimport { Component } from '@angular/core';\r\nimport { FormBuilder, Validators } from \"@angular/forms\";\r\nimport { GoogleLoginProvider, SocialAuthService } from \"angularx-social-login\";\r\nimport { UserDataService } from \"../user-data.service\";\r\nimport { Router } from \"@angular/router\";\r\nimport { Store } from \"@ngrx/store\";\r\nimport { userLoginAction } from \"../store/user/user.action\";\r\nlet StartPageComponent = class StartPageComponent {\r\n    constructor(formBuilder, udService, router, store, socialAuthService) {\r\n        this.formBuilder = formBuilder;\r\n        this.udService = udService;\r\n        this.router = router;\r\n        this.store = store;\r\n        this.socialAuthService = socialAuthService;\r\n        this.title = 'calorie calendar';\r\n        this.loginForm = this.formBuilder.group({\r\n            email: ['', Validators.required],\r\n            password: ['', Validators.required],\r\n        });\r\n        this.isLoggedin = false;\r\n    }\r\n    ngOnInit() {\r\n        this.socialAuthService.authState.subscribe((user) => {\r\n            this.socialUser = user;\r\n            this.isLoggedin = user != null;\r\n        });\r\n    }\r\n    async loginWithGoogle() {\r\n        const users = this.udService.loadUsers();\r\n        try {\r\n            const authUser = await this.socialAuthService.signIn(GoogleLoginProvider.PROVIDER_ID);\r\n            this.udService.userId = authUser.id;\r\n            console.log(this.udService.userId);\r\n            const user = {\r\n                id: authUser.id,\r\n                gender: '',\r\n                heightCm: 0,\r\n                weightkg: 0,\r\n                minCal: 0,\r\n                maxCal: 0,\r\n                fats: 0,\r\n                proteins: 0,\r\n                carbohydrates: 0,\r\n            };\r\n            if (!users.length) {\r\n                this.udService.saveUser(user, authUser.id);\r\n            }\r\n            else {\r\n                const foundUser = users.find(user => user.id === authUser.id);\r\n                this.udService.saveUser(foundUser !== null && foundUser !== void 0 ? foundUser : user, this.udService.userId);\r\n            }\r\n            this.store.dispatch(userLoginAction({ id: authUser.id }));\r\n            this.router.navigate(['/profile']);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n            // Any error handling scenario\r\n        }\r\n    }\r\n    logOut() {\r\n        this.udService.userId = '';\r\n        this.socialAuthService.signOut();\r\n    }\r\n};\r\nStartPageComponent.ctorParameters = () => [\r\n    { type: FormBuilder },\r\n    { type: UserDataService },\r\n    { type: Router },\r\n    { type: Store },\r\n    { type: SocialAuthService }\r\n];\r\nStartPageComponent = __decorate([\r\n    Component({\r\n        selector: 'app-start-page',\r\n        template: __NG_CLI_RESOURCE__0,\r\n        providers: [SocialAuthService],\r\n        styles: [__NG_CLI_RESOURCE__1]\r\n    })\r\n], StartPageComponent);\r\nexport { StartPageComponent };\r\n"]},"metadata":{},"sourceType":"module"}